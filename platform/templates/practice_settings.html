{% extends "base.html" %}

{% block title %}Problem Settings - My Flask Website{% endblock %}

{% block content %}
    <h2>Customize Problem Settings</h2>
    <p>You selected {{ prob_type }} by {{prob_topic}}</p>

    <form id="NumProbsForm" onsubmit="return submitForm()" method="GET">
        <label for="num_problems">Number of Problems:</label>
        <select id="num_problems" name="num_problems" required>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
        <!-- <button type="submit">Generate Problems</button>     -->
    </form>
    <br>
    {% if prob_type == "Solving Quadratic Equations" %}
    <p>Special Customizations for {{prob_type}}</p>
    <form id="SolvingQuadraticEquationsForm" onsubmit="return submitForm()" method="GET">
        <label for="a">What values of a are allowed?</label>
        <select id="a" name="a" required>
            <option value="let a be any number, ">a can be any number</option>
            <option value="let a = 1, ">a = 1</option>
            <!-- <option value="Let a>=1">a>=1</option> -->
        </select>
        <!-- <button type="submit">Generate Problems</button>     -->
        <br>
        <label for="b">What values of b are allowed?</label>
        <select id="b" name="b" required>
            <option value="let b be any number, ">b can be any number</option>
            <option value="let b = 0, ">b = 0</option>
        </select>
        <!-- <button type="submit">Generate Problems</button>     -->
        <br>
        <label for="c">What values of c are allowed?</label>
        <select id="c" name="c" required>
            <option value="and let c be any number">c can be any number</option>
            <option value="and let c = 0">c=0</option>
        </select>
        <br><br>
        <!-- <button type="submit">Generate Problems</button>     -->
    </form>
    {% endif %}
    
    <form id="Final" onsubmit="return submitForm()" method="GET">
        <button type="submit">Generate Problems</button>    
    </form>

    <script>
        function submitForm() {
            const numProblems = document.getElementById('num_problems').value;
            const problemType = "{{ problem_type }}";
            const problemTopic = "{{ problem_topic }}";

            // Only execute logic for 'a', 'b', and 'c' if the problem type is 'Solving Quadratic Equations'
            let details = "In the problem, ";

            console.log(problemType);
            if (problemType === "Solving_Quadratic_Equations") {
                const a = document.getElementById('a').value; // Default to an empty string if no value
                const b = document.getElementById('b').value; // Default to an empty string if no value
                const c = document.getElementById('c').value; // Default to an empty string if no value
                details += a + b + c; // Concatenate values
            }


            // Create a form dynamically
            const form = document.createElement("form");
            form.method = "POST";
            form.action = `/generate_problems/${problemType}/${problemTopic}`; // Action URL without num_problems and details

            // Add hidden inputs to the form
            const inputs = [
                { name: "details", value: details }, // Include 'details' regardless of whether it's empty or not
                { name: "num_problems", value: numProblems } // Send num_problems via POST
            ];            inputs.forEach(inputData => {
                const input = document.createElement("input");
                input.type = "hidden";
                input.name = inputData.name;
                input.value = inputData.value;
                form.appendChild(input);
            });
    
            // Append the form to the document and submit
            document.body.appendChild(form);
            form.submit();
    
            return false; // Prevent default behavior
        }
    </script>
    
{% endblock %}
